var width,height,radius,b,colors,sizes,totalSize,vis,partition,arc,entries;function setVars(c,d,a,e){totalSize=0;width=c;height=d;radius=Math.min(width,height)/2;b=a;colors=e;sizes={};entries={};partition=d3.layout.partition().size([2*Math.PI,radius*radius]).value(function(f){return f.size});arc=d3.svg.arc().startAngle(function(f){return f.x}).endAngle(function(f){return f.x+f.dx}).innerRadius(function(f){return Math.sqrt(f.y)}).outerRadius(function(f){return Math.sqrt(f.y+f.dy)});vis=d3.select("#chart").append("svg:svg").attr("width",width).attr("height",height).append("svg:g").attr("id","container").attr("transform","translate("+width/2+","+height/2+")")}function getMethods(d){var a=[];for(var e in d){try{if(typeof(d[e])=="function"){a.push(e+": "+d[e].toString())}else{a.push(e+": "+d[e].toString())}}catch(c){a.push(e+": inaccessible")}}return a}function createVisualization(d){var c,e;initializeBreadcrumbTrail();d3.select("#togglelegend").on("click",toggleLegend);vis.append("svg:circle").attr("r",radius).style("opacity",0);c=partition.nodes(d).filter(function(h){return(h.dx>0.005)});e=vis.data([d]).selectAll("path").data(c).enter().append("svg:path").attr("display",function(h){return h.depth?null:"none"}).attr("d",arc).attr("fill-rule","evenodd").style("fill",function(h){return h.color}).style("opacity",1).on("mouseover",mouseover);d3.select("#container").on("mouseleave",mouseleave);totalSize=e.node().__data__.value;for(var g in e.node().__data__.children){g=e.node().__data__.children[g];var a=(100*g.value/totalSize).toPrecision(3);var f=a+"%";if(a<0.1){f="< 0.1%"}sizes[g.name]=f}drawLegend()}function mouseover(e){var a,f,c;a=(100*e.value/totalSize).toPrecision(3);f=a+"%";if(a<0.1){f="< 0.1%"}d3.select("#percentage").text(f);d3.select("#explanation").style("visibility","");c=getAncestors(e);updateBreadcrumbs(c,f);d3.selectAll("path").style("opacity",0.3);vis.selectAll("path").filter(function(d){return(c.indexOf(d)>=0)}).style("opacity",1)}function mouseleave(a){d3.select("#trail").style("visibility","hidden");d3.selectAll("path").on("mouseover",null);d3.selectAll("path").transition().duration(1000).style("opacity",1).each("end",function(){d3.select(this).on("mouseover",mouseover)});d3.select("#explanation").transition().duration(1000).style("visibility","hidden")}function getAncestors(a){var d=[],c=a;while(c.parent){d.unshift(c);c=c.parent}return d}function initializeBreadcrumbTrail(){var a=d3.select("#sequence").append("svg:svg").attr("width",width).attr("height",50).attr("id","trail");a.append("svg:text").attr("id","endlabel").style("fill","#000")}function breadcrumbPoints(e,a){var c=[];c.push("0,0");c.push(b.w+",0");c.push(b.w+b.t+","+(b.h/2));c.push(b.w+","+b.h);c.push("0,"+b.h);if(a>0){c.push(b.t+","+(b.h/2))}return c.join(" ")}function updateBreadcrumbs(c,e){var a,d;a=d3.select("#trail").selectAll("g").data(c,function(f){return f.name+f.depth});d=a.enter().append("svg:g");d.append("svg:polygon").attr("points",breadcrumbPoints).style("fill",function(f){return f.color});d.append("svg:text").attr("x",(b.w+b.t)/2).attr("y",b.h/2).attr("dy","0.35em").attr("text-anchor","middle").text(function(f){return f.name});a.attr("transform",function(g,f){return"translate("+f*(b.w+b.s)+", 0)"});a.exit().remove();d3.select("#trail").select("#endlabel").attr("x",(c.length+0.5)*(b.w+b.s)).attr("y",b.h/2).attr("dy","0.35em").attr("text-anchor","middle").text(e);d3.select("#trail").style("visibility","")}function drawLegend(){var a,c,d;a={w:190,h:30,s:3,r:3};c=d3.select("#legend").append("svg:svg").attr("width",a.w).attr("height",d3.keys(colors).length*(a.h+a.s));for(var e in colors){entries[e]=e+" - "+sizes[e]}d=c.selectAll("g").data(d3.entries(colors)).enter().append("svg:g").attr("transform",function(g,f){return"translate(0,"+f*(a.h+a.s)+")"});d.append("svg:rect").attr("rx",a.r).attr("ry",a.r).attr("width",a.w).attr("height",a.h).style("fill",function(f){return f.value});d.append("svg:text").attr("x",a.w/2).attr("y",a.h/2).attr("dy","0.35em").attr("text-anchor","middle").text(function(f){return entries[f.key]})}function toggleLegend(){var a=d3.select("#legend");if(a.style("visibility")=="hidden"){a.style("visibility","")}else{a.style("visibility","hidden")}};