function Sun_Burst(c,d,a,e,b){this.totalSize=0;this.width=c;this.height=d;this.radius=Math.min(this.width,this.height)/2;this.b=a;this.colors=e;this.uid=b;this.entries={};this.seq="#sequence_"+this.uid;this.trailid="#trail_"+this.uid;this.endid="endlabel_"+this.uid;this.bwidth=this.width;this.partition=d3.layout.partition().size([2*Math.PI,this.radius*this.radius]).value(function(f){return f.size});this.arc=d3.svg.arc().startAngle(function(f){return f.x}).endAngle(function(f){return f.x+f.dx}).innerRadius(function(f){return Math.sqrt(f.y)}).outerRadius(function(f){return Math.sqrt(f.y+f.dy)});this.vis=d3.select("#chart_"+this.uid).append("svg:svg").attr("width",this.width).attr("height",this.height).append("svg:g").attr("id","container_"+this.uid).attr("transform","translate("+this.width/2+","+this.height/2+")")}Sun_Burst.prototype={setBreadWidth:function(b,a){this.seq=b;this.bwidth=a;this.trailid="#trail";this.endid="#endlabel"},getAncestors:function(a){var c=[],b=a;while(b.parent){c.unshift(b);b=b.parent}return c},createVisualization:function(c,a){var b,e,d=this;this.mouseover=function(h){var i,g;i=d.makePctStr(h.value,d.totalSize);d3.select("#percentage_"+d.uid).text(i);d3.select("#explanation_"+d.uid).style("visibility","");g=d.getAncestors(h);d.updateBreadcrumbs(g,i);d3.select("#chart_"+d.uid).selectAll("path").style("opacity",0.3);d.vis.selectAll("path").filter(function(j){return(g.indexOf(j)>=0)}).style("opacity",1)};this.mouseleave=function(g){d3.select(d.trailid).style("visibility","hidden");d3.select("#chart_"+d.uid).selectAll("path").on("mouseover",null);d3.select("#chart_"+d.uid).selectAll("path").transition().duration(1000).style("opacity",1).each("end",function(){d3.select(this).on("mouseover",d.mouseover)});d3.select("#explanation_"+d.uid).transition().duration(1000).style("visibility","hidden")};this.initializeBreadcrumbTrail();this.vis.append("svg:circle").attr("r",this.radius).style("opacity",0);b=this.partition.nodes(c);e=this.vis.data([c]).selectAll("path").data(b).enter().append("svg:path").attr("display",function(g){return g.depth?null:"none"}).attr("d",this.arc).attr("fill-rule","evenodd").style("fill",function(g){return g.color}).style("opacity",1).on("mouseover",this.mouseover);d3.select("#container_"+this.uid).on("mouseleave",this.mouseleave);this.totalSize=e.node().__data__.value;for(var f in e.node().__data__.children){f=e.node().__data__.children[f];this.entries[f.name]=f.name+" - "+this.makePctStr(f.value,this.totalSize)}this.drawLegend(a)},makePctStr:function(b,c){var a=(100*b/c).toPrecision(3);var d=a+"%";if(a<0.1){d="< 0.1%"}return d},initializeBreadcrumbTrail:function(){var a=d3.select(this.seq).append("svg:svg").attr("width",this.bwidth).attr("height",50).attr("id",this.trailid);a.append("svg:text").attr("id",this.endid).style("fill","#000")},updateBreadcrumbs:function(d,f){var c,e;alert(this.trailid);c=d3.select(this.trailid).selectAll("g").data(d,function(g){return g.name+g.depth});e=c.enter().append("svg:g");var b=this;var a=function(j,g){var h=[];h.push("0,0");h.push(b.b.w+",0");h.push(b.b.w+b.b.t+","+(b.b.h/2));h.push(b.b.w+","+b.b.h);h.push("0,"+b.b.h);if(g>0){h.push(b.b.t+","+(b.b.h/2))}return h.join(" ")};e.append("svg:polygon").attr("points",a).style("fill",function(g){return g.color});e.append("svg:text").attr("x",(this.b.w+this.b.t)/2).attr("y",this.b.h/2).attr("dy","0.35em").attr("text-anchor","middle").text(function(g){return g.name});c.attr("transform",function(h,g){return"translate("+g*(b.b.w+b.b.s)+", 0)"});c.exit().remove();d3.select(this.trailid).select(this.endid).attr("x",(d.length+0.5)*(this.b.w+this.b.s)).attr("y",this.b.h/2).attr("dy","0.35em").attr("text-anchor","middle").text(f);d3.select(this.trailid).style("visibility","")},drawLegend:function(a){var b,d;b=d3.select("#legend_"+this.uid).append("svg:svg").attr("width",a.w).attr("height",d3.keys(this.colors).length*(a.h+a.s));d=b.selectAll("g").data(d3.entries(this.colors)).enter().append("svg:g").attr("transform",function(f,e){return"translate(0,"+e*(a.h+a.s)+")"});d.append("svg:rect").attr("rx",a.r).attr("ry",a.r).attr("width",a.w).attr("height",a.h).style("fill",function(e){return e.value});var c=this;d.append("svg:text").attr("x",a.w/2).attr("y",a.h/2).attr("dy","0.35em").attr("text-anchor","middle").text(function(e){return c.entries[e.key]})},};